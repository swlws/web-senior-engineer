# 0-1 工程架构设计

## ✅ 一、项目架构（Project Architecture）

目标：确定技术路线、运行模型、产物形态，决定整个工程上限。

### 1. 技术栈选型

- UI 框架：Vue2 / Vue3 / React / Svelte / Solid。（是否需要 SSR？Prerender？）
- 状态管理：Vuex/Pinia、Redux、Jotai、Recoil、Zustand。（考虑多人协作、调试能力）
- 路由策略：Hash / History、是否需要动态路由 / 权限路由。
- 服务端对接：REST / GraphQL / gRPC-Web / WebSocket。

### 2. 应用架构模式

- 单体 SPA or 多 SPA（微前端架构）。
- 是否需要 BFF（前端后端） 中间层。
- 是否需要 模块联邦 / 模块共享策略（webpack5、rspack、vite 构建体系）。
- 是否需要 低代码搭建能力或插件扩展能力。

### 3. 运行架构

- SSR / CSR / SSG / ISR + CDN 分发策略。
- 多设备布局方案（响应式 / 适配 / 多端统一）。
- 国际化、主题定制能力是否一开始就纳入工程体系。

## ✅ 二、工程体系（Engineering System）

目标：让项目可维护、可协作、可扩展、能跑到生产环境。

### 1. 目录结构 & 模块划分

关键目标：清晰性、可扩展性、一致性

推荐关注点：

- 分层（如 API 层 / domain 层 / UI 层）
- hooks、composables 的组织结构
- 公共库抽离：utils/, components/, services/

### 2. 构建体系

- Vite / webpack5 / Rspack / Turbopack 选型。
- Chunk 分包策略（initial / async / vendor）。
- 构建速度优化：esbuild、SWC、HMR、缓存策略等。

### 3. 代码规范体系

- ESLint + Prettier + Stylelint（或 Biome 一站式）
- git hooks（Husky / lefthook）
- 提交规范（commitlint、commitizen）
- TypeScript 强类型体系（是否开启 strict mode?）

### 4. 测试体系

- 单元测试：Vitest / Jest
- 组件测试：Testing-Library / Cypress Component Testing
- E2E 测试：Cypress / Playwright
- 接口 Mock 体系（MSW 等）

### 5. CI/CD

- 自动构建 & 发布流程（GitHub Actions / GitLab CI）
- 多环境体系：dev / test / stage / prod
- Sentry / DataDog / APM 监控集成
- 自动化版本控制（semver）、自动 changelog

## ✅ 三、业务支撑能力（Cross-cutting Concerns）

目标：让项目不仅能跑，更能持续迭代、解决复杂业务需求。

### 1. 权限体系

- 登录态、token 刷新
- 菜单权限、按钮权限、路由权限
- 统一拦截器体系（请求拦截 / 响应拦截）

### 2. 配置体系

- 可配置化页面：远程配置、开关体系
- 埋点上报体系：PV/UV/事件/曝光
- 实验体系（AB Test）

### 3. 性能体系

- 首屏性能（秒开率、骨架屏、懒加载、Preload）
- 运行时性能（虚拟列表、分片渲染、rAF、IdleCallback）
- 构建性能监控（bundle analyzer）

### 4. 组件库 & 设计体系

- 是否自研组件库
- 主题切换、多皮肤支持
- DSL（领域 UI 模型）及组件开发规范

## ✅ 四、长期演进（Maintainability & Scalability）

目标：工程 6 个月、1 年后仍能稳定演进，不会腐化。

### 1. 可扩展的架构模式

- Plugin Architecture（类 VSCode plugin）
- Domain-driven design（业务界限划分）
- 微前端拆分策略（如果未来可能需要）

### 2. 监控与可观测性

- 错误监控（Sentry）
- 性能监控（FMP、LCP、CLS）
- 日志体系（前端 logging → FE-BFF → 后端）

### 3. 工程健康度度量

- 文件/模块依赖图
- 技术债审计（循序清理）
- API schema（OpenAPI/GraphQL）自动生成
