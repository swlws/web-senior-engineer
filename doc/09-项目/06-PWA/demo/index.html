<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <meta name="theme-color" content="#0ea5e9" />
    <link rel="manifest" href="./manifest.webmanifest" />
    <link rel="icon" href="./icons/icon-192.png" />
    <link rel="apple-touch-icon" href="./icons/icon-192.png" />
    <title>PWA TTL Cache Demo</title>
    <link rel="stylesheet" href="./styles.css" />
  </head>
  <body>
    <main>
      <h1>PWA 缓存演示（3 分钟有效期）</h1>
      <p>
        打开网络面板观察资源是否命中 <code>Cache</code> 或
        <code>Network</code>。
      </p>

      <section class="card">
        <h2>静态资源演示</h2>
        <img src="./icons/icon-192.png" alt="logo" width="96" height="96" />
        <button id="reload-img">再次请求图片</button>
        <span id="img-status"></span>
      </section>

      <section class="card">
        <h2>接口演示</h2>
        <button id="fetch-api">请求 /api/time</button>
        <pre id="api-result"></pre>
        <p class="hint">
          可在 3 分钟内重复点击，首次后将命中缓存；3 分钟后强制走网络。
        </p>
      </section>

      <section class="card">
        <h2>控制</h2>
        <button id="clear-caches">清空所有缓存</button>
      </section>
    </main>

    <script src="./app.js" type="module"></script>
    <script>
      if ("serviceWorker" in navigator) {
        window.addEventListener("load", () => {
          navigator.serviceWorker
            .register("/sw.js", { scope: "/" })
            .then((reg) => console.log("SW registered", reg))
            .catch((err) => console.error("SW registration failed", err));
        });
      }
    </script>
  </body>
</html>
