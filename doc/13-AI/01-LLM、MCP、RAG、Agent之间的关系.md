# LLM、MCP、RAG、Agent之间的关系

可以把 LLM、MCP、RAG、Agent 看成 四个层级/角色不同的组件，而不是同一维度的东西。

> LLM 是大脑，RAG 是外接记忆，MCP 是工具与上下文协议，Agent 是会思考、会用工具、会完成任务的“智能体”。

## 一、核心定义（不混维度）

### 1️⃣ LLM（Large Language Model）

- 是什么
  - 一个“通用推理 + 生成引擎”
  - 输入：prompt + context
  - 输出：文本 / JSON / code
- 特点
  - ❌ 不知道你本地代码
  - ❌ 不会主动调用工具
  - ❌ 没有长期记忆
  - ✅ 很强的推理与生成能力

👉 LLM ≠ 应用，只是能力内核

### 2️⃣ RAG（Retrieval Augmented Generation）

#### 是什么

- 一种 “给 LLM 补充外部知识” 的模式
- 本质是：
  检索（Search） + 上下文拼接 + LLM 推理

```txt
用户问题
   ↓
向量检索 / 文档检索
   ↓
相关内容注入 Prompt
   ↓
LLM 生成回答
```

#### 解决什么问题

- LLM 不知道你：
  - 项目代码
  - 内部文档
  - 业务规范
  - 历史决策

👉 RAG = 让 LLM“查资料再回答”

### 3️⃣ MCP（Model Context Protocol）

#### 是什么

- Anthropic 提出的 “模型 ↔ 工具 / 数据 / 环境” 的标准协议
- 核心目标：
  > 让 LLM 用“统一方式”访问外部能力

#### MCP 能做什么

- 读文件
- 查项目结构
- 执行命令
- 调用 API
- 获取 IDE 上下文（VS Code）

#### 本质

```txt
LLM  ←→  MCP Server  ←→  本地能力 / 工具 / 数据
```

👉 MCP = LLM 的“标准化外设接口”

### 4️⃣ Agent（智能体）

#### 是什么

> 一个“会规划 → 会调用工具 → 会反思 → 会完成任务”的系统

Agent 通常包含：  

```txt
Agent = LLM
      + 记忆（RAG / 状态）
      + 工具调用（MCP / Function Call）
      + 规划与循环（Plan / Act / Reflect）
```

#### Agent 具备的能力

- 拆任务
- 多轮决策
- 自动调用工具
- 根据结果调整策略

## 二、它们的关系（结构图）

```txt
                   ┌────────────┐
                   │    LLM     │   ← 核心推理
                   └─────▲──────┘
                         │
          ┌──────────────┼──────────────┐
          │                              │
      ┌───┴───┐                    ┌─────┴─────┐
      │  RAG  │                    │   MCP     │
      │ 知识  │                    │ 工具/环境 │
      └───▲───┘                    └─────▲─────┘
          │                              │
     向量库 / 文档                文件 / IDE / API

                         ▲
                         │
                    ┌────┴────┐
                    │  Agent  │
                    │ 行为系统 │
                    └─────────┘
```

## 三、对比表（不再混）

| 维度        | LLM | RAG | MCP | Agent |
| --------- | --- | --- | --- | ----- |
| 类型        | 模型  | 模式  | 协议  | 系统    |
| 是否智能      | ✅   | ❌   | ❌   | ✅     |
| 是否调用工具    | ❌   | ❌   | ✅   | ✅     |
| 是否有规划     | ❌   | ❌   | ❌   | ✅     |
| 是否有记忆     | ❌   | ✅   | ❌   | ✅     |
| 是否可独立完成任务 | ❌   | ❌   | ❌   | ✅     |

## 四、一个完整的真实案例（IDE Agent）

> “分析当前项目架构，并给出重构建议”

执行流程：

1. Agent 接收任务
2. Agent 规划：
   - 读取项目结构
   - 分析依赖
   - 识别问题
3. Agent 通过 MCP
   - 读文件
   - 扫描 package.json
4. Agent 通过 RAG
   - 检索历史规范 / 最佳实践
5. LLM 推理
6. Agent 汇总结果 → 输出建议

👉 LLM 不知道怎么做，是 Agent 在指挥

## 六、一句“工程级”总结

- LLM：能力
- RAG：知识增强
- MCP：工具接口
- Agent：把这些能力组织起来完成任务的系统
