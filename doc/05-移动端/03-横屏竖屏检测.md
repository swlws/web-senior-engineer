# æ¨ªå±ç«–å±æ£€æµ‹

## ä¸€ã€æœ€å¯é çš„åˆ¤æ–­é€»è¾‘ï¼ˆç»“è®ºå…ˆè¡Œï¼‰

> æ°¸è¿œä¼˜å…ˆç”¨ã€Œå®½é«˜å…³ç³»ã€åˆ¤æ–­ï¼Œè€Œä¸æ˜¯ orientation å­—æ®µ

```js
const isLandscape = () => window.innerWidth > window.innerHeight;
```

åŸå› ï¼š

- orientation API å…¼å®¹æ€§å·®
- iOS / Android è¡Œä¸ºä¸ä¸€è‡´
- PWAã€WebViewã€å°æ¸¸æˆä¸­ç»å¸¸å¤±æ•ˆ

## äºŒã€æ–¹å¼ä¸€ï¼šå®½é«˜æ¯”åˆ¤æ–­ï¼ˆâœ… æ¨èï¼‰

åŸç†

- æ¨ªå±ï¼šwidth > height
- ç«–å±ï¼šheight >= width

Web / H5

```js
function getOrientation() {
  return window.innerWidth > window.innerHeight ? "landscape" : "portrait";
}

window.addEventListener("resize", () => {
  console.log(getOrientation());
});
```

ä¼˜ç‚¹:

- è·¨å¹³å°æœ€ç¨³å®š
- ä¸ä¾èµ–ä»»ä½•ç§æœ‰ API
- WebView / å°ç¨‹åº / å†…åµŒé¡µéƒ½å¯ç”¨

æ³¨æ„ç‚¹

> é”®ç›˜å¼¹èµ·å¯èƒ½è§¦å‘ resizeï¼ˆéœ€ debounce æˆ–åˆ¤æ–­å˜åŒ–å¹…åº¦ï¼‰

## ä¸‰ã€æ–¹å¼äºŒï¼šScreen Orientation APIï¼ˆâš ï¸ å¯é€‰ï¼‰

ä½¿ç”¨æ–¹å¼

```js
screen.orientation.type;
// portrait-primary
// landscape-primary
```

```js
screen.orientation.addEventListener("change", () => {
  console.log(screen.orientation.type);
});
```

é—®é¢˜

- iOS Safari æ”¯æŒä¸å®Œæ•´
- éƒ¨åˆ† WebView è¿”å› undefined
- å°ç¨‹åºä¸å¯ç”¨

ğŸ‘‰ ä¸èƒ½ä½œä¸ºå”¯ä¸€åˆ¤æ–­æ–¹å¼

## å››ã€æ–¹å¼ä¸‰ï¼šCSS åª’ä½“æŸ¥è¯¢ï¼ˆçº¯æ ·å¼å±‚ï¼‰

åŸç†

```css
@media (orientation: portrait) {
  body {
    background: red;
  }
}

@media (orientation: landscape) {
  body {
    background: blue;
  }
}
```

JS ç›‘å¬

```js
const mql = window.matchMedia("(orientation: landscape)");

mql.addEventListener("change", (e) => {
  console.log(e.matches ? "landscape" : "portrait");
});
```

é€‚ç”¨åœºæ™¯

- åªå½±å“æ ·å¼
- ä¸æ¶‰åŠä¸šåŠ¡é€»è¾‘

## äº”ã€æ–¹å¼å››ï¼šå¾®ä¿¡å°ç¨‹åº / Taro

### å°ç¨‹åºåŸç”Ÿ

```js
wx.onDeviceOrientationChange((res) => {
  console.log(res.value); // portrait / landscape
});
```

âš ï¸ æ³¨æ„ï¼š

- è¿™æ˜¯è®¾å¤‡æ–¹å‘ï¼Œä¸æ˜¯è§†å£æ–¹å‘
- å¹³æ”¾æ‰‹æœºå¯èƒ½è§¦å‘è¯¯åˆ¤

### Taroï¼ˆæ¨èï¼‰

```ts
import Taro from "@tarojs/taro";

const isLandscape = () => {
  const { windowWidth, windowHeight } = Taro.getSystemInfoSync();
  return windowWidth > windowHeight;
};
```

ç›‘å¬ï¼š

```ts
Taro.onWindowResize(({ size }) => {
  const { windowWidth, windowHeight } = size;
});
```

## å…­ã€React / Vue å°è£…ï¼ˆå·¥ç¨‹çº§ï¼‰

### React Hook

```ts
import { useEffect, useState } from "react";

export function useOrientation() {
  const get = () =>
    window.innerWidth > window.innerHeight ? "landscape" : "portrait";

  const [orientation, set] = useState(get);

  useEffect(() => {
    const handler = () => set(get());
    window.addEventListener("resize", handler);
    return () => window.removeEventListener("resize", handler);
  }, []);

  return orientation;
}
```

### Vue Composable

```ts
import { ref, onMounted, onUnmounted } from "vue";

export function useOrientation() {
  const orientation = ref(
    window.innerWidth > window.innerHeight ? "landscape" : "portrait"
  );

  const update = () => {
    orientation.value =
      window.innerWidth > window.innerHeight ? "landscape" : "portrait";
  };

  onMounted(() => window.addEventListener("resize", update));
  onUnmounted(() => window.removeEventListener("resize", update));

  return orientation;
}
```

## ä¸ƒã€å¸¸è§å‘æ€»ç»“

### 1ï¸âƒ£ resize â‰  æ—‹è½¬

- é”®ç›˜å¼¹å‡º
- åœ°å€æ éšè—
- åˆ†å±æ¨¡å¼

è§£å†³ï¼š

```js
Math.abs(prevWidth - currWidth) > 50;
```

### 2ï¸âƒ£ iOS Safari çš„ 100vh é—®é¢˜

- æ¨ªç«–å±åˆ‡æ¢æ—¶ vh å˜åŒ–ä¸å‡†ç¡®
- å»ºè®®é…åˆ JS è®¾ç½®é«˜åº¦

### 3ï¸âƒ£ orientationchange å·²åºŸå¼ƒ

```js
window.orientation; // âŒ ä¸å¯é 
```

## å…«ã€æ¨èç»„åˆæ–¹æ¡ˆï¼ˆæœ€ä½³å®è·µï¼‰

```txt
JS é€»è¾‘ï¼šwindow.innerWidth > innerHeight
CSS æ ·å¼ï¼š@media (orientation)
å°ç¨‹åºï¼šwindowWidth / windowHeight
```
