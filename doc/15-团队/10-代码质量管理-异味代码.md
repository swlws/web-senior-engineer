# 异味代码

代码质量管理中的 “代码异味（Code Smell）” 指的是：

> 代码没有直接导致运行错误，但从设计、可维护性、可读性、扩展性等角度看，存在潜在问题或未来可能恶化的迹象。

一般可分为 5 大类、20+ 常见异味，下面给你按工程师视角、简明分类梳理👇

## ✅ 一、结构类异味（Structure Smells）

涉及模块/类/函数的结构与规模问题。

1. 过长函数（Long Function）
  函数逻辑过于庞大，职责不清、难维护。
2. 过大的类（Large Class）
  包含太多字段、方法、逻辑，违反单一职责。
3. 过深的嵌套（Deep Nesting）
  多层 if/for/switch，代码阅读困难。
4. 过长参数列表（Long Parameter List）
  参数超过 3～5 个需重构（可封装到对象）。
5. 重复代码（Duplicated Code）
  项目中多处逻辑相同或相似。
6. 数据泥团（Data Clumps）
  多个字段总是成组出现，应封装为对象。

## ✅ 二、设计类异味（Design Smells）

与面向对象设计、模块边界有关。

1. 过强耦合（Tight Coupling）
  模块/类间依赖过多，修改牵一发而动全身。
2. 循环依赖（Cyclic Dependencies）
  A 依赖 B，B 又依赖 A，不易测试或扩展。
3. 散弹式修改（Shotgun Surgery）
  一个需求变更要修改多个文件。
4. 发散式变化（Divergent Change）
  一个类负责太多不同变化原因（违反 SRP）。
5. 不够通用的接口（Inappropriate Abstraction）
  抽象设计不好：过度或不足抽象。
6. 特性嫉妒（Feature Envy）
  一个方法太关心其他对象的数据，而不是自身。

## ✅ 三、命名与可读性异味（Readability Smells）

与代码理解和沟通成本有关。

1. 含糊/错误命名（Poor Naming）
  变量/函数名无法表达其含义。
2. 魔法数字（Magic Numbers）
  硬编码的数字或字符串没有语义说明。
3. 过长/难懂的表达式
  三目嵌套、复杂条件判断等。
4. 无意义注释 / 过度注释
  注释重复表达代码本身含义。

## ✅ 四、状态与逻辑控制异味（State & Logic Smells）

1. 命令与查询混合（Command–Query Mixed）
  方法既返回数据又修改状态。
2. 多处条件分支分散（Switch / If Overuse）
  大量条件逻辑，应该多态或策略模式。
3. 错误处理不一致
  有些用 try/catch、有些返回特殊值、有些静默失败。
4. 布尔参数（Boolean Parameter）
  暴露内部流程，应拆分方法。

## ✅ 五、工程与架构异味（Project-Level Smells）

1. God Object（上帝类）
  一个模块承担太多职责，所有逻辑都依赖它。
2. 分层架构破坏（Layer Violation）
  例如页面层直接操作数据库。
3. 未使用的代码（Dead Code）
  永远不会运行或没人调用的代码。
4. 模块边界模糊
  配置、状态、服务、工具混在一起。

## ⭐ 常见为什么叫“异味（Smell）”？

因为它们`不是 bug`，但会导致：

- 逻辑越来越难维护
- 新需求时修改成本极高
- Bug 更容易出现
- 团队沟通与协作困难
- 它们是代码质量下降的 信号。
