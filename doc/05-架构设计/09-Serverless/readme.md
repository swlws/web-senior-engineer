# Serverless 架构设计

“Serverless（无服务器架构）”并不是“没有服务器”，而是指开发者无需关心服务器的运维和管理，由云厂商自动完成资源分配、扩缩容、负载均衡、容灾等工作。开发者只需关注业务逻辑代码本身。

## 🧠 一句话理解

你写函数，云来跑。按次付费，无需管机。

## 💡 核心概念

| 概念                              | 说明                                                                                                                       |
| --------------------------------- | -------------------------------------------------------------------------------------------------------------------------- |
| **FaaS（Function as a Service）** | “函数即服务”，你只需编写业务函数，平台会在需要时执行。典型代表：AWS Lambda、阿里云函数计算、腾讯云 SCF、Vercel Functions。 |
| **BaaS（Backend as a Service）**  | “后端即服务”，常见如数据库、认证、文件存储、推送等由云服务提供。比如 Firebase、Supabase。                                  |
| **事件驱动（Event-driven）**      | 函数通常由事件触发（HTTP 请求、消息队列、定时器、对象存储上传等）。                                                        |
| **自动伸缩（Auto-scaling）**      | 根据请求量自动启动或销毁实例，无需手动运维。                                                                               |
| **按需计费（Pay-as-you-go）**     | 按实际调用次数或执行时长计费，而不是按服务器常驻时间。                                                                     |

## ⚙️ 工作流程示意

1. 你部署一个函数（如 hello.js）。
2. 用户请求触发事件（HTTP 调用、上传文件、定时任务）。
3. 云平台启动执行环境（如容器/轻量沙箱），运行该函数。
4. 运行结束后自动回收资源。

## 🧩 常见 Serverless 框架 / 平台

| 平台                                               | 说明                                                            |
| -------------------------------------------------- | --------------------------------------------------------------- |
| **AWS Lambda**                                     | Serverless 领域开山鼻祖，支持多语言和事件源。                   |
| **Vercel**                                         | 专注于前端项目（Next.js、SvelteKit、Nuxt），自动构建+部署+CDN。 |
| **Netlify Functions**                              | 适合前端+API 组合项目。                                         |
| **阿里云函数计算（FC）**                           | 国内成熟方案，可配合 API 网关。                                 |
| **腾讯云 SCF（Serverless Cloud Function）**        | 微信生态常用，支持小程序后端逻辑。                              |
| **Cloudflare Workers / Deno Deploy / Bun.serve()** | 更轻量、边缘计算化（Edge Functions）。                          |

## 🧰 前端工程师常用的场景

| 场景                    | 示例                                                        |
| ----------------------- | ----------------------------------------------------------- |
| **静态网站 + 动态函数** | Vercel / Netlify 托管前端 + Serverless 函数处理表单、接口。 |
| **图片 / 视频处理**     | 上传时触发函数自动压缩或生成缩略图。                        |
| **Webhook 接收**        | GitHub、Slack、支付回调。                                   |
| **API 聚合层**          | 前端调用 Serverless 统一转发第三方接口。                    |
| **定时任务（Cron）**    | 定时清理数据库、发送报告等。                                |

## ⚖️ 优缺点

| 优点           | 缺点                         |
| -------------- | ---------------------------- |
| 无需运维服务器 | 冷启动延迟（首次执行较慢）   |
| 自动扩缩容     | 执行时间有限制（通常几十秒） |
| 按需付费       | 状态管理困难（无持久连接）   |
| 快速部署上线   | 调试和本地开发较复杂         |

## 🔍 举个例子：Node.js Serverless 函数

例如在 Vercel 中：

```js
// api/hello.js
export default async function handler(req, res) {
  return res.status(200).json({ message: "Hello Serverless!" });
}
```

部署后访问：

```txt
https://your-project.vercel.app/api/hello
```

Vercel 会自动创建执行环境，无需你部署服务器。
