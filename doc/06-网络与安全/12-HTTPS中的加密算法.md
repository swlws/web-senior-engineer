# HTTPS 中的加密算法

在 HTTPS（HTTP over SSL/TLS） 过程中，确实使用了多种加密算法来保证通信的安全性。整个过程会涉及到对称加密、非对称加密、摘要算法等不同类型的加密手段，组合使用以实现 机密性（Confidentiality）、完整性（Integrity） 和 身份验证（Authentication）。

## 🧩 一、HTTPS 握手阶段（TLS Handshake）

在浏览器与服务器正式传输数据前，会先进行一次「TLS 握手」，这个阶段主要目的是：

- 验证服务器身份（有时也验证客户端）
- 协商加密算法
- 生成共享的“会话密钥”

### 握手中使用的加密算法类型

| 加密类别                             | 示例算法              | 作用          | 特点               |
| -------------------------------- | ----------------- | ----------- | ---------------- |
| **非对称加密（Asymmetric Encryption）** | RSA、ECDHE、DH、ECDH | 保护密钥交换过程    | 公钥加密、私钥解密，安全但计算慢 |
| **数字签名算法（Signature Algorithm）**  | RSA、ECDSA、Ed25519 | 验证证书的真实性    | 用于服务器证书签名        |
| **哈希算法（摘要算法）**                   | SHA-256、SHA-384   | 用于握手验证数据完整性 | 不可逆，防篡改          |

### 🔍 举个例子

在常见的 TLS 1.2 握手中：

1. 客户端发送支持的算法列表（如 RSA, ECDHE, AES_256_GCM_SHA384）。
2. 服务器选择算法组合（Cipher Suite），例如：

   ```nginx
   TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384

  ```
  它代表：

  - 密钥交换：ECDHE（椭圆曲线 Diffie-Hellman）
  - 身份认证：RSA
  - 对称加密算法：AES-256-GCM
  - 摘要算法：SHA-384

## 🔐 二、会话阶段（数据传输阶段）

握手结束后，双方会得到相同的 会话密钥（session key），这时候加密通信主要使用：

| 加密类别                           | 示例算法                                  | 作用           | 特点         |
| ------------------------------ | ------------------------------------- | ------------ | ---------- |
| **对称加密（Symmetric Encryption）** | AES、ChaCha20、3DES（已过时）                | 加密实际数据内容     | 速度快，适合大数据量 |
| **消息认证码（MAC）/ AEAD**           | HMAC-SHA256、AES-GCM、ChaCha20-Poly1305 | 校验数据完整性、防止篡改 | 结合加密与校验一体化 |

## 📦 三、典型 Cipher Suite 解析

举例：

```nginx
TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256
```

| 部分            | 含义                                              | 类型 |
| ------------- | ----------------------------------------------- | -- |
| `TLS`         | 协议版本                                            |    |
| `ECDHE`       | 密钥交换算法（Ephemeral Elliptic Curve Diffie-Hellman） |    |
| `RSA`         | 服务器身份验证算法                                       |    |
| `AES_128_GCM` | 对称加密算法 + 认证模式（Galois/Counter Mode）              |    |
| `SHA256`      | 摘要算法，用于握手验证                                     |    |

## 🔁 四、TLS 1.3 的变化（现代 HTTPS）

TLS 1.3 对加密算法体系做了大幅精简与安全升级：

| 分类   | TLS 1.2                           | TLS 1.3                     |
| ---- | --------------------------------- | --------------------------- |
| 密钥交换 | RSA、DH、ECDHE                      | 仅 ECDHE、DHE（前向保密）           |
| 对称加密 | AES-CBC、AES-GCM、ChaCha20-Poly1305 | 仅 AES-GCM、ChaCha20-Poly1305 |
| 摘要算法 | SHA-1、SHA-256、SHA-384             | 仅 SHA-256、SHA-384           |
| 数字签名 | RSA、ECDSA                         | RSA-PSS、ECDSA、Ed25519       |

TLS 1.3 默认启用了 前向保密（Forward Secrecy），即使将来服务器私钥泄漏，也无法解密以前的通信内容。

## 🧠 总结：HTTPS 中加密算法的分工

| 加密阶段 | 算法类型         | 示例                    | 主要作用      |
| ---- | ------------ | --------------------- | --------- |
| 握手阶段 | 非对称加密        | RSA / ECDHE           | 密钥交换、身份认证 |
| 握手阶段 | 哈希算法         | SHA-256 / SHA-384     | 签名、消息摘要   |
| 会话阶段 | 对称加密         | AES / ChaCha20        | 加密实际数据    |
| 会话阶段 | 消息认证码 / AEAD | HMAC / GCM / Poly1305 | 校验数据完整性   |
