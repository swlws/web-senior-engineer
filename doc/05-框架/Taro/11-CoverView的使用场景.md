# cover-view 的使用场景

cover-view 的使用场景其实非常明确：

> “只要你需要一个在微信小程序中滚动时保持流畅、始终浮在页面上、且不会因 WebView 重绘而卡顿的元素，就用 cover-view。”

## 🎯 1. 固定悬浮按钮（最典型场景）

小程序里 fixed 在 ScrollView 内部几乎必卡，尤其 iOS。

✔ 推荐：

- 返回顶部按钮
- 全局播放按钮
- 悬浮菜单、客服入口
- 小红点提醒的悬浮控件
  ```html
  <cover-view class="float-btn">客服</cover-view>
  ```

原生层绘制，滚动时不会重布局，最稳。

## 🎯 2. 视频播放控件、图片控件的覆盖 UI

小程序中的 video、camera、canvas、map 等 原生组件的优先级高于普通 View，普通 view 会被压在下面，看不见。

- 🚫 普通 view：压不住
- 👍 cover-view：专为压在原生组件上设计

使用场景：

- 视频播放的自定义控制条
- 播放/暂停按钮
- 相机拍照按钮 UI
- 在地图上叠加自定义按钮（非官方控件）

示例：

```tsx
<video src="xxx" id="v" />
<cover-view  class="control-bar">播放</cover-view>
```

## 🎯 3. 顶部吸顶栏（抗卡顿、避免抖动）

普通吸顶（position: sticky/fixed）在 WebView 中：

- ScrollView 内几乎无效
- 滚动抖动明显
- iOS 层频繁掉帧

使用 cover-view：

- ✔ 完全不参与重绘
- ✔ 滚动完全不受影响

例如：

- 自定义导航栏
- 吸顶 Tabs
- 粘性过滤栏

## 🎯 4. 覆盖弹窗（覆盖地图 / 视频 / Camera 等）

普通弹窗无法覆盖原生组件（特别是 map）。

cover-view 可以：

- 地图上的筛选弹窗
- Camera 拍摄页面的引导 UI
- 视频全屏状态下的浮层按钮
- 遮罩层、模态框（仅覆盖原生组件区域）

## 🎯 5. 地图上的“自定义 UI”

微信地图控件限制非常多，无法嵌 DOM。用 cover-view 可以做：

- 自定义定位按钮
- 地图上方的一行功能按钮
- 自定义筛选标签
- 自定义 marker 说明文字（非真正 marker）

## 🎯 6. 避免 setData 带来的滚动卡顿场景

如果你遇到：

- 列表滚动中频繁刷新
- 导致 DOM 重绘 → 页面掉帧

把“可能导致卡顿的固定区域”移到 cover-view 层能解耦重绘。

例如：

- 列表吸顶工具栏
- 搜索框固定在顶部
- 滚动过程中保持 UI 稳定不闪动

## 🎯 7. 自定义 TabBar（替代原生 tabBar）

微信原生 tabBar 虽然也很快，但想要：

- 动画
- 中间凸起按钮
- 自定义交互
- 完全自定义样式

使用 cover-view：

```html
<cover-view class="custom-tabbar"> ... </cover-view>
```

## 🎯 8. 避免重绘的广告、徽标、计数器等“独立 UI”

适合那些：

- 经常更新（如计时器）
- 但不应该影响页面滚动
- 也不希望被 WebView 重绘挤掉帧

例如：

- 浮动购物车数量
- 页面右上角的实时消息数
- 限时抢购倒计时浮层

## ❗ 不适合使用 cover-view 的场景（避免踩坑）

| 场景                                           | 原因                           |
| ---------------------------------------------- | ------------------------------ |
| **复杂 UI**（多层嵌套、动画丰富）              | cover-view 支持 CSS 非常有限   |
| **需要 overflow、transform、z-index 精确控制** | 原生层不遵守 Web 样式规则      |
| **需要事件穿透控制**                           | 事件机制与 WebView 不一致      |
| **H5 端（Taro H5）**                           | H5 没有 cover-view，需降级处理 |

## 📌 一张图总结使用场景

```txt
普通 view（WebView 层）
----------------------------
| 适合布局正常页面           |
| 会随滚动重绘，可能卡顿      |
----------------------------

cover-view（Native 层）
============================
| 固定/浮层 UI               |
| 覆盖原生组件（video,map）   |
| 不随滚动重绘 → 流畅         |
| UI 复杂度有限               |
============================
```
