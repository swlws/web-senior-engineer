# ä¸ºä»€ä¹ˆé€‰æ‹© Lit

WebComponent çš„ç”Ÿæ€ç¡®å®éå¸¸å¤šï¼ˆStencilã€Litã€Hybridsã€Vanillaã€FASTã€Svelte WebComponent æ¨¡å¼ã€Vue/React è‡ªå®šä¹‰å…ƒç´ æ¨¡å¼â€¦ï¼‰ï¼Œä½†æœ€ç»ˆé€‰æ‹© Lit çš„æ ¸å¿ƒç†ç”±å¯ä»¥æ€»ç»“æˆï¼š

Lit = WebComponent çš„æœ€è½»é‡ã€æœ€æˆç†Ÿã€æœ€å·¥ç¨‹åŒ–ã€æœ€ç°ä»£çš„å®ç°æ–¹å¼ã€‚
å®ƒä»…åœ¨åŸç”Ÿèƒ½åŠ›ä¸ŠåŠ â€œæœ€å°å¿…è¦å¢å¼ºâ€ã€‚

ä¸‹é¢ä»å·¥ç¨‹ã€ç»´æŠ¤ã€æ€§èƒ½ã€ç”Ÿæ€ã€DXï¼ˆå¼€å‘ä½“éªŒï¼‰äº”å¤§ç»´åº¦è§£é‡Šã€‚

## 1) ğŸ§© Lit æ˜¯â€œå¢å¼ºåŸç”Ÿâ€çš„æœ€å°æ¡†æ¶ï¼Œè€Œä¸æ˜¯æ›¿ä»£åŸç”Ÿ

WebComponent åŸç”Ÿçš„é—®é¢˜åŒ…æ‹¬ï¼š

- Shadow DOM éš¾ç”¨
- å±æ€§/å±æ€§æ˜ å°„ç¹çï¼ˆå±æ€§å˜åŒ–é€šçŸ¥ï¼‰
- æ¸²æŸ“æ€§èƒ½ä¸ç¨³å®šï¼ˆinnerHTML vs diff patchï¼‰
- ç¼ºå°‘å“åº”å¼æ¨¡å‹
- ç¼ºå°‘æ¨¡æ¿ç³»ç»Ÿ

Lit çš„å®šä½ï¼šåªåœ¨è¿™äº›ç—›ç‚¹å¤„åŠ ä¸€ä¸ªâ€œè–„è–„çš„å¢å¼ºå±‚â€

| WebComponent åŸç”Ÿ                 | Lit å¢å¼ºèƒ½åŠ›                |
| --------------------------------- | --------------------------- |
| æ²¡æœ‰å“åº”å¼                        | âœ”ï¸ reactive properties      |
| éœ€è¦æ‰‹å†™ template/innerHTML       | âœ”ï¸ html`` æ¨¡æ¿              |
| æ‰‹åŠ¨ Reflect attribute â†” property | âœ”ï¸ è‡ªåŠ¨åå°„                 |
| éœ€è¦æ‰‹åŠ¨æ“ä½œ shadow               | âœ”ï¸ createRenderRoot()       |
| DOM diff éœ€è¦è‡ªå·±å†™               | âœ”ï¸ è¶…é«˜æ€§èƒ½ incremental DOM |
| ç”Ÿå‘½å‘¨æœŸå¤æ‚                      | âœ”ï¸ æ›´æ¸…æ™°çš„ç”Ÿå‘½å‘¨æœŸ hooks   |

ç›¸æ¯” Stencil/Stiven/Vue/React ç­‰æ¡†æ¶ï¼š

> Lit æ˜¯åŸç”Ÿ API çš„è‡ªç„¶å»¶ä¼¸ï¼›å…¶ä»–æ–¹æ¡ˆæ›´åƒæ˜¯é‡æ–°åˆ›é€ ä¸€å¥—æ¡†æ¶åå†å¯¼å‡º WebComponentã€‚

æ‰€ä»¥ Lit çš„å­¦ä¹ ä¸ Web æ ‡å‡†é«˜åº¦ä¸€è‡´ã€‚

## 2) âš¡ Lit çš„æ€§èƒ½æ˜¯æ‰€æœ‰ WebComponent æ¡†æ¶é‡Œæœ€å¼ºçš„ä¹‹ä¸€

Lit ä½¿ç”¨çš„æ˜¯ æç²¾ç¡®çš„ DOM å±€éƒ¨æ›´æ–°ï¼ˆfine-grained DOM diffï¼‰ï¼Œæ€§èƒ½ä¸Šé•¿æœŸæ˜¯ Benchmark çš„å‰ 3ã€‚

ä¸€å¥è¯è§£é‡Šæ€§èƒ½ä¼˜åŠ¿ï¼š

> æ¨¡æ¿ä¸­çš„è¡¨è¾¾å¼ä½ç½®ä¼šè¢«ç¼–è¯‘ä¸ºé™æ€ç‚¹ä½ï¼ˆmarkerï¼‰ï¼ŒLit åªæ›´æ–°ç‚¹ä½ï¼Œä¸ diff æ•´é¢—æ ‘ã€‚

ç›¸æ¯”ä¹‹ä¸‹ï¼š

| æ¡†æ¶                     | diff ç­–ç•¥                          | ç»“æœ                 |
| ------------------------ | ---------------------------------- | -------------------- |
| Vue/React â†’ WebComponent | Virtual DOM diff                   | é¢å¤–ä¸€å±‚ä¸­é—´å±‚       |
| Stencil                  | ç¼–è¯‘å™¨ä¼˜åŒ–ä½†ä¾èµ– VDOM              | ä¸­ç­‰                 |
| Vanilla WebComponent     | æ‰‹å†™ DOM                           | å®¹æ˜“å‡ºé”™ï¼Œç»´æŠ¤æˆæœ¬é«˜ |
| **Lit**                  | âœ¨ incremental DOMï¼Œæ—  Virtual DOM | æœ€å¿«ã€æœ€è½»           |

è¿™ä¹Ÿæ˜¯ Google å†…éƒ¨å¤§é‡é¡¹ç›®ï¼ˆMapsã€Material Webï¼‰é‡‡çº³ Lit çš„ä¸»è¦åŸå› ã€‚

## 3) ğŸ“¦ Lit æ‰“åŒ…ä½“ç§¯æå°ï¼ˆå°åˆ°ç¦»è°±ï¼‰

lit æ˜¯ ~5KBï¼ˆgzipï¼‰

æ—  runtimeã€æ—  VDOMã€æ—  framework

ç›¸æ¯”ï¼š

| æ¡†æ¶             | ä½“ç§¯            |
| ---------------- | --------------- |
| React            | 40KB+           |
| Vue              | 20KB+           |
| Svelteï¼ˆç¼–è¯‘åï¼‰ | ä»ç„¶ä¼šæ¯” Lit å¤§ |
| Stencil          | ç¼–è¯‘å™¨æœ¬èº«ä¸å°  |

> Lit åŸºæœ¬å°±æ˜¯ WebComponent å¼€å‘çš„â€œæœ€å°æˆæœ¬æ¡†æ¶â€ã€‚

## 4) ğŸ› ï¸ Lit æœ‰å®Œæ•´çš„å·¥ç¨‹åŒ–ç”Ÿæ€ï¼ˆè€Œä¸”ç¨³å®šï¼‰

Lit æ˜¯ç›®å‰ç”Ÿæ€æœ€æˆç†Ÿçš„ WebComponent æŠ€æœ¯æ ˆï¼š

- ç±»ä¼¼ React çš„å¼€å‘ä½“éªŒï¼ˆæ¨¡ç‰ˆ + å“åº”å¼çŠ¶æ€ï¼‰
- TS æ”¯æŒæä¼˜ç§€
- SSR æ”¯æŒï¼ˆlit-ssrï¼‰
- Hydrateï¼ˆlit-hydrationï¼‰
- è¡¨å•é›†æˆï¼ˆReactiveControllerï¼‰
- å®˜æ–¹ Router
- Material Web Component å®Œå…¨åŸºäº Lit é‡åš
- Google Workspace / Chrome å›¢é˜Ÿå†…éƒ¨å¤§é‡ä½¿ç”¨

Stencil ä¹Ÿå·¥ç¨‹åŒ–ï¼Œä½†ï¼š

- ç¼–è¯‘å™¨é”å®šåº¦é«˜
- æ„å»ºç›®å½•å¤æ‚
- éœ€è¦ Rollup
- ç”Ÿæˆçš„ WebComponent å…¶å®è¿˜æ˜¯ mini-framework

> Lit æ›´æ¥è¿‘â€œè§„èŒƒçº§æ ‡å‡†â€ï¼Œç”Ÿå‘½å‘¨æœŸæ›´é•¿ï¼Œä¸å®¹æ˜“è¿‡æ—¶ã€‚

## 5) ğŸ§ª Lit çš„ DX éå¸¸æ¥è¿‘æ¡†æ¶çº§ä½“éªŒ

å¼€å‘ä½“éªŒå‡ ä¹æ˜¯ï¼š

> â†’ å†™ WebComponent = å†™ React/Vue ä¸€æ ·ç®€å•

Lit è®©ä½ å†™ WebComponent æ—¶å¯ä»¥è½»æ¾åšåˆ°ï¼š

```ts
@customElement("my-counter")
class MyCounter extends LitElement {
  @state()
  count = 0;

  render() {
    return html`
      <button @click=${() => this.count++}>+1</button>
      <div>${this.count}</div>
    `;
  }
}
```

è¿™åœ¨åŸç”Ÿ WebComponent é‡Œè¦å†™å¾ˆå¤šä»£ç ã€‚

å¯¹æ¯”ä¸€ä¸‹ï¼ŒåŸç”Ÿå†™ä¸€ä¸ªç®€å•å±æ€§æ›´æ–°å°±éå¸¸ç—›è‹¦ï¼š

- å±æ€§å˜åŒ–ç›‘å¬
- æ‰‹åŠ¨ rerender
- æ‰‹åŠ¨ patch DOM
- æ‰‹åŠ¨æ“ä½œ shadow DOM

Lit å…¨åŒ…äº†ã€‚

## 6) ğŸ”¥ ä¸å…¶ä»–æ–¹æ¡ˆå¯¹æ¯”ï¼ˆæ ¸å¿ƒå¯¹æ¯”æ€»ç»“ï¼‰

### â‘  Lit vs åŸç”Ÿï¼ˆVanilla WebComponentï¼‰

| å¯¹æ¯”é¡¹   | åŸç”Ÿ       | Lit                    |
| -------- | ---------- | ---------------------- |
| æ¸²æŸ“     | innerHTML  | é«˜æ€§èƒ½å±€éƒ¨æ›´æ–°         |
| å“åº”å¼   | âŒ æ—       | âœ”ï¸ æœ‰                  |
| å†™æ³•     | å•°å—¦ã€æ˜“é”™ | ç®€æ´ç°ä»£               |
| å­¦ä¹ æˆæœ¬ | ä¸­ç­‰       | æ›´ä½ï¼ˆåŸºäºç°ä»£ TS/JSï¼‰ |

### â‘¡ Lit vs Stencil

| é¡¹       | Stencil                 | Lit                      |
| -------- | ----------------------- | ------------------------ |
| æ¶æ„     | ç¼–è¯‘å™¨ç”Ÿæˆç±» React VDOM | incremental DOMï¼Œæ—  VDOM |
| å¤æ‚åº¦   | é«˜                      | ä½                       |
| è¿è¡Œæ—¶   | æœ‰                      | æå°                     |
| ä¸Šæ‰‹æˆæœ¬ | é«˜ï¼ˆStencil ä¸“ç”¨è¯­æ³•ï¼‰  | ä½ï¼ˆåŸç”Ÿ + TSï¼‰          |
| SSR      | å¼±                      | å¼ºï¼ˆå®˜æ–¹ SSR + hydrateï¼‰ |

### â‘¢ Lit vs React/Vue/Svelte WebComponent æ¨¡å¼

| é¡¹       | React/Vue/Svelte             | Lit              |
| -------- | ---------------------------- | ---------------- |
| é¢å¤–ä¾èµ– | å¿…é¡»å¼•å…¥æ¡†æ¶ runtime         | æ— ï¼ˆ5KBï¼‰        |
| æ€§èƒ½     | VDOM                         | incremental DOM  |
| ç”Ÿå‘½å‘¨æœŸ | æ¡†æ¶ç”Ÿå‘½å‘¨æœŸ + CustomElement | çº¯ CustomElement |
| å…¼å®¹æ€§   | æ¡¥æ¥é€»è¾‘å¤æ‚                 | åŸç”ŸåŒ¹é…åº¦æœ€é«˜   |
| æ‰“åŒ…ä½“ç§¯ | å¤§                           | æå°             |

Lit æ˜æ˜¾æ›´é€‚åˆâ€œç»„ä»¶åº“ + è·¨æ¡†æ¶å¤ç”¨â€ã€‚

## ğŸ”š æœ€ç»ˆæ€»ç»“ï¼šä¸ºä»€ä¹ˆé€‰æ‹© Litï¼Ÿ

å› ä¸ºå®ƒåˆšå¥½ç«™åœ¨ WebComponent åŸç”Ÿèƒ½åŠ›çš„ä¸è¶³ç‚¹ä¸Šè¡¥å¼ºï¼Œè¡¥å¾—åˆæœ€å°‘ã€æœ€ç²¾å‡†ã€‚

ä¸€å¥è¯æ€»ç»“ï¼š

> Lit = æœ€ç¬¦åˆ Web æ ‡å‡†ã€æœ€è½»é‡ã€æœ€æŒä¹…çš„ WebComponent å·¥å…·ã€‚
> æ— æ¡†æ¶é”å®šï¼Œå·¥ç¨‹åŒ–æˆç†Ÿï¼Œæ€§èƒ½é¡¶çº§ï¼Œé•¿æœŸå®‰å…¨ã€‚
