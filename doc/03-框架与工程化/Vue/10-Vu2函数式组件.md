# Vue2 函数式组件

在 Vue 2 里，组件的 functional: true/false 是一个很关键的配置，决定了组件是不是 函数式组件。它对 render 的执行和组件的生命周期有直接影响。

## 📌 区别总结

### 1. functional: false（默认值）

- 普通组件。
- 会创建一个 Vue 实例（this 指向组件实例）。
- 可以使用：
  - data / computed / watch / methods / 生命周期钩子
  - this.$props / this.$slots / this.$scopedSlots / this.$emit / this.$listeners / this.$refs
- render 函数签名：

    ```js
    render(h) {
      return h('div', {}, this.$slots.default)
    }
    ```

    这里的 this 就是组件实例。

- ✅ 适合需要状态、响应式、生命周期的场景。
- ❌ 额外有实例开销（性能稍差于函数式组件）。

### 2. functional: true

- 函数式组件。
- 不会创建 Vue 实例（没有 this）。
- 完全是无状态、无实例的渲染函数。
- 渲染更快，占用内存更少。
- render 函数签名：

  ```js
    export default {
    functional: true,
    render(h, context) {
      // context 包含所有数据
      // context.props
      // context.slots()
      // context.scopedSlots
      // context.data
      // context.listeners
      // context.parent
      return h('div', {}, context.slots().default)
    }
  }
  ```

- 没有生命周期钩子，只能依赖外部传入的 props/slots。

- ✅ 适合“纯展示组件”、“包装组件”、“高阶组件”。
- ❌ 不能有本地状态，也不能使用生命周期。

## 📌 对 render 的影响

| 特性                    | `functional: false`                    | `functional: true`                           |
| --------------------- | -------------------------------------- | -------------------------------------------- |
| `this`                | 指向 Vue 组件实例                            | **不存在**，改用 `context` 参数                      |
| `data`/`methods`      | 可以定义并在 `this` 中访问                      | **不支持**，必须依赖外部 props                         |
| 生命周期钩子                | 全部支持                                   | **不支持**                                      |
| `slots`/`scopedSlots` | 通过 `this.$slots` / `this.$scopedSlots` | 通过 `context.slots()` / `context.scopedSlots` |
| 性能                    | 多一层实例，稍慢                               | 更轻量、渲染更快                                     |
